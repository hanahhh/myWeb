import React, { useState, useEffect } from 'react'
import './About.scss'
import { motion } from 'framer-motion'
import { client } from '../../client'

const About = () => {
  const [drawLength, setDrawLength] = useState(0);

  const [about, setAbout] = useState([
    {
      aboutMe: '',
    }
  ])

  useEffect(() => {
      const query = '*[_type == "abouts"]';

      client.fetch(query).then((data) => {
        setAbout(data)
      });
    }, []);
  
  window.addEventListener('scroll', () => {
    let scrollPercentage = (document.documentElement.scrollTop + document.body.scrollTop) / (document.documentElement.scrollHeight - document.documentElement.clientHeight)
    let prc = window.screen.width<=900 ? 3.5 : 2.1
    setDrawLength( scrollPercentage * prc)
  })

  let pathVariants = {
    hidden: {
      opacity: 0,
      pathLength: 0
    },
    visible: {
      opacity: 1,
      pathLength: drawLength,
      transition: {
        duration: 0.4,
        ease: "linear"
      }
    }
  }
  
  return (
    <div className='about' id='about'>
      <div className="wrapper">
        <div className="left">
          <svg width="1120" height="1679" viewBox="0 0 1120 1679" fill="none" xmlns="http://www.w3.org/2000/svg">
            <motion.path 
              d="M312.364 0C312.364 115.651 396.183 115.651 312.364 176.749C207.59 253.123 242.514 456.057 312.364 538.977C382.213 621.896 423.686 580.436 452.063 552.069C480.439 523.702 548.106 596.802 604.858 570.617C661.611 544.432 568.842 544.411 565.568 559.707C562.294 575.002 548.106 568.435 556.837 538.977C565.568 509.518 689.987 600.075 790.396 576.072C890.804 552.069 771.842 527.521 778.39 547.705C784.939 567.889 781.119 579.891 755.471 542.25C729.823 504.609 658.337 597.348 698.718 559.707C739.1 522.066 568.296 502.427 565.568 466.422C562.839 430.418 450.426 464.813 552.471 512.792C654.517 560.77 776.207 549.342 802.401 512.792C828.595 476.242 824.229 445.147 778.39 454.421C776.571 454.966 772.824 458.785 772.388 469.695C771.842 483.333 757.654 484.424 745.648 484.424C736.044 484.424 641.966 484.424 596.127 484.424C587.396 485.152 569.497 480.497 567.751 456.057C566.004 431.618 565.568 390.594 565.568 373.138C564.658 368.774 567.314 359.827 585.213 358.954C603.112 358.081 709.087 356.408 759.837 355.681C766.021 355.499 778.39 358.736 778.39 373.138C778.39 387.54 772.57 429.327 769.659 448.42C768.204 456.966 759.618 474.387 736.917 475.696C714.216 477.005 639.419 476.242 604.858 475.696C596.127 475.878 578.665 471.332 578.665 451.693C578.665 432.054 578.665 396.595 578.665 381.321C575.754 375.32 568.187 366.919 561.202 381.321V421.144C561.202 432.418 559.456 446.783 552.471 414.052C543.74 373.138 561.202 283.126 591.216 276.58C621.229 270.034 639.783 303.856 684.53 288.036C729.277 272.216 607.587 297.856 612.498 258.032C617.409 218.209 627.232 254.759 636.509 198.025C643.93 152.637 658.519 146.382 664.885 148.928C671.433 152.201 679.728 164.748 660.519 188.751C636.509 218.755 658.337 249.85 647.423 261.851C636.509 273.853 637.6 264.579 640.874 258.032C644.148 251.486 656.154 248.758 660.519 258.032C664.885 267.306 677.436 263.488 679.073 254.759C680.71 246.031 685.622 240.576 691.079 241.667C689.623 231.302 689.332 210.463 699.81 210.026C712.906 209.481 712.41 177.295 691.079 175.658C669.747 174.022 668.159 142.381 691.079 145.655C713.998 148.928 740.737 185.478 730.369 238.394C720.001 291.309 793.67 288.582 742.374 325.677C738.009 328.95 730.587 337.242 735.826 344.225C742.374 352.953 699.81 359.5 699.81 330.587C699.81 301.674 723.82 289.673 694.353 272.216C664.885 254.759 698.718 258.578 706.358 232.393C713.998 206.208 720.546 187.66 722.729 210.026C724.475 227.92 718.363 240.394 715.089 244.394C708.905 251.304 703.302 267.415 730.369 276.58C764.202 288.036 747.285 339.861 759.837 344.225C772.388 348.589 787.121 352.953 785.484 373.138C784.175 389.285 782.028 416.598 781.119 428.236C780.209 434.6 785.812 448.202 815.498 451.693C852.605 456.057 827.503 510.816 810.041 516.61C792.578 522.404 832.414 567.889 892.441 542.25C952.468 516.61 911.541 600.075 988.484 552.069C1050.04 513.664 1062.15 572.435 1060.52 606.622C1059.24 629.17 1076.78 660.737 1157.11 606.622C1257.51 538.977 1261.88 771.866 988.484 674.266C715.089 576.666 770.75 744.093 802.401 770.278C834.052 796.464 903.901 717.908 691.079 720.09C478.256 722.272 740.191 870.655 612.498 848.834C484.805 827.013 356.02 752.822 334.192 800.828C312.364 848.834 251.246 870.655 146.472 709.18C41.6975 547.705 -102.367 796.464 115.912 870.655C334.192 944.846 84.1397 930.092 52.6115 1034.31C40 1076 177.41 1222.72 70 1146C0 1096 94 1080 146.472 1119.5C174.334 1140.47 247.021 1206.15 402.435 1240.19C596.704 1282.74 214.715 1140.91 201.618 1197.64C188.522 1254.37 161.237 1311.11 201.618 1334.02C233.924 1352.35 320.581 1375.12 359.871 1384.21C399.525 1392.57 432.995 1394.25 249.64 1334.02C222.355 1324.93 165.821 1312.2 157.963 1334.02C148.14 1361.3 106.667 1449.67 174.334 1473.67C228.467 1492.88 298.753 1515.13 327.129 1523.86C346.41 1529.68 388.466 1518.41 402.435 1426.76C403.527 1416.32 403.527 1394.71 394.796 1391.85C409.348 1380.57 439.761 1340.79 445 1271.83C445.728 1255.1 411.821 1216.84 270.376 1197.64C251.095 1194.73 211.441 1193.28 207.075 1210.73C201.618 1232.55 190.705 1319.84 132.86 1457.31C130.678 1466.4 141.373 1489.6 201.618 1509.68C276.925 1534.77 388.247 1564.23 352.231 1531.5C316.215 1498.77 222.355 1492.22 249.64 1531.5" stroke="black" stroke-width="3"
              variants={ pathVariants }
              initial = "hidden"
              animate = "visible"/>
          </svg>
        </div>
        <div className="center"></div>
        <motion.div 
          className="right"
          whileInView={{y: [50, 0], opacity: [0,1]}}
          transition={{duration: 1}}
        >
          <h1>ABOUT ME</h1>
          <div className="line"></div>
          <p>{about[0].aboutMe}</p>
          <a download href={about[0].myCV}><button>Download my CV</button></a>
          
        </motion.div>
      </div>
    </div>
  )
}

export default About